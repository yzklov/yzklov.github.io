<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="zh-CN">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.3" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png?v=5.1.3">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png?v=5.1.3">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.3" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="常见文件头    后缀 文件头 文件尾    PNG 89 50 4E 47 0D 0A 1A 0A AE 42 60 82   GIF 47 49 46 38 39 61 00 3B   JPEG FF D8 FF FF D9   zip 50 4B 03 04 50 4B   rar 52 61 72 21    伪加密 一个加密的压缩包，由三部分组成：压缩源文件数据区、压缩源文件目录区、压缩">
<meta property="og:type" content="article">
<meta property="og:title" content="misc">
<meta property="og:url" content="http://example.com/misc.html">
<meta property="og:site_name" content="yzklov">
<meta property="og:description" content="常见文件头    后缀 文件头 文件尾    PNG 89 50 4E 47 0D 0A 1A 0A AE 42 60 82   GIF 47 49 46 38 39 61 00 3B   JPEG FF D8 FF FF D9   zip 50 4B 03 04 50 4B   rar 52 61 72 21    伪加密 一个加密的压缩包，由三部分组成：压缩源文件数据区、压缩源文件目录区、压缩">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="http://example.com/img/100.png">
<meta property="og:image" content="http://example.com/img/71.png">
<meta property="og:image" content="http://example.com/img/99.png">
<meta property="og:image" content="http://example.com/img/101.png">
<meta property="og:image" content="http://example.com/img/102.png">
<meta property="og:image" content="http://example.com/img/103.png">
<meta property="og:image" content="http://example.com/img/104.png">
<meta property="og:image" content="http://example.com/img/118.png">
<meta property="og:image" content="http://example.com/img/119.png">
<meta property="og:image" content="http://example.com/img/120.png">
<meta property="og:image" content="http://example.com/img/121.png">
<meta property="og:image" content="http://example.com/img/122.png">
<meta property="og:image" content="http://example.com/img/123.png">
<meta property="og:image" content="http://example.com/img/131.png">
<meta property="og:image" content="http://example.com/img/124.png">
<meta property="og:image" content="http://example.com/img/125.png">
<meta property="og:image" content="http://example.com/img/126.png">
<meta property="og:image" content="http://example.com/img/127.png">
<meta property="og:image" content="http://example.com/img/129.png">
<meta property="og:image" content="http://example.com/img/130.png">
<meta property="og:image" content="http://example.com/img/132.png">
<meta property="og:image" content="http://example.com/img/133.png">
<meta property="og:image" content="http://example.com/img/134.png">
<meta property="og:image" content="http://example.com/img/135.png">
<meta property="og:image" content="http://example.com/img/184.png">
<meta property="og:image" content="http://example.com/img/185.png">
<meta property="og:image" content="http://example.com/img/186.png">
<meta property="og:image" content="http://example.com/img/187.png">
<meta property="og:image" content="http://example.com/img/188.jpg">
<meta property="og:image" content="http://example.com/img/188.png">
<meta property="og:image" content="http://example.com/img/189.png">
<meta property="og:image" content="http://example.com/img/191.png">
<meta property="article:published_time" content="2023-04-11T16:03:14.000Z">
<meta property="article:modified_time" content="2023-07-24T11:00:03.934Z">
<meta property="article:author" content="yzklov">
<meta property="article:tag" content="web">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://example.com/img/100.png">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '',
    scheme: 'Pisces',
    version: '5.1.3',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://example.com/misc.html"/>





  <title>misc | yzklov</title>
  








<meta name="generator" content="Hexo 7.1.1"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-CN">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">yzklov</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">熟能生巧</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            Tags
          </a>
        </li>
      

      
        <li class="menu-item menu-item-search">
          
            <a href="javascript:;" class="popup-trigger">
          
            
              <i class="menu-item-icon fa fa-search fa-fw"></i> <br />
            
            Search
          </a>
        </li>
      
    </ul>
  

  
    <div class="site-search">
      
  <div class="popup search-popup local-search-popup">
  <div class="local-search-header clearfix">
    <span class="search-icon">
      <i class="fa fa-search"></i>
    </span>
    <span class="popup-btn-close">
      <i class="fa fa-times-circle"></i>
    </span>
    <div class="local-search-input-wrapper">
      <input autocomplete="off"
             placeholder="Searching..." spellcheck="false"
             type="text" id="local-search-input">
    </div>
  </div>
  <div id="local-search-result"></div>
</div>



    </div>
  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://example.com/misc.html">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="yzklov">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">misc</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2023-04-12T00:03:14+08:00">
                2023-04-12
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <p><strong>常见文件头</strong></p>
<table>
<thead>
<tr>
<th>后缀</th>
<th>文件头</th>
<th>文件尾</th>
</tr>
</thead>
<tbody><tr>
<td>PNG</td>
<td>89 50 4E 47 0D 0A 1A 0A</td>
<td>AE 42 60 82</td>
</tr>
<tr>
<td>GIF</td>
<td>47 49 46 38 39 61</td>
<td>00 3B</td>
</tr>
<tr>
<td>JPEG</td>
<td>FF D8 FF</td>
<td>FF D9</td>
</tr>
<tr>
<td>zip</td>
<td>50 4B 03 04</td>
<td>50 4B</td>
</tr>
<tr>
<td>rar</td>
<td>52 61 72 21</td>
<td></td>
</tr>
</tbody></table>
<p><strong>伪加密</strong></p>
<p>一个加密的压缩包，由三部分组成：压缩源文件数据区、压缩源文件目录区、压缩源文件目录结束标志<br><img src="/img/100.png"></p>
<p>1、压缩源文件数据区<br>50 4B 03 04 压缩包的文件头标记 4bytes<br>14 00 解压文件所需的pkware版本 2bytes<br>09 00 全局方式位标记 2bytes (这里可以来判断有无加密，0奇数 00 加密，0偶数 00 无加密)</p>
<p>2、压缩源文件目录区(从第二个50 4B开始)<br>50 4B 01 02 目录中文件文件头标记 4bytes<br>1F 00 压缩使用的pkware 版本 2bytes<br>14 00 解压文件所需的pkware版本 2bytes<br>09 00 全局方式位标记 2bytes<br>(这里可以来判断有无加密，解决伪加密，0奇数 00 加密，0偶数 00 无加密)</p>
<p>3、压缩源文件目录结束标志<br>50 4B 05 06 目录结束标记 4bytes</p>
<p>压缩源文件数据区(50 4B 03 04起)和压缩源文件目录区(50 4B 01 02起)的全局方式位标记均为 0偶数 00，则是未加密<br>压缩源文件数据区(50 4B 03 04起)和压缩源文件目录区(50 4B 01 02起)的全局方式位标记均为 0奇数 00，则是真加密<br>压缩源文件数据区(50 4B 03 04起)的全局方式位标记为 0偶数 00，压缩源文件目录(50 4B 01 02起)的全局方式位标记为 0奇数 00，则是伪加密</p>
<h2 id="一些思路总结"><a href="#一些思路总结" class="headerlink" title="一些思路总结"></a>一些思路总结</h2><p><strong>图片题</strong><br>1、图片宽高<br>2、图片备注<br>3、010editor查看搜索flag、binwalk能否分离<br>4、隐写术，outguess、、、<br><strong>压缩包</strong><br>1、伪加密<br>2、能否binwalk<br><strong>excel</strong><br>1、在010editor中查找flag<br>2、binwalk<br><strong>gif</strong><br>1、stegsolve分析</p>
<h3 id="ISCC-奇特的信息"><a href="#ISCC-奇特的信息" class="headerlink" title="ISCC 奇特的信息"></a>ISCC 奇特的信息</h3><p>使用subbreaker破解</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">subbreaker break --lang EN --text &quot;内容&quot;</span><br></pre></td></tr></table></figure>
<p><img src="/img/71.png"><br>注意：命令行输入粘贴的文本不可随便换行(相当于回车)，可能会当成命令执行</p>
<h2 id="buuctf"><a href="#buuctf" class="headerlink" title="buuctf"></a>buuctf</h2><h3 id="zip伪加密"><a href="#zip伪加密" class="headerlink" title="zip伪加密"></a>zip伪加密</h3><p>打开压缩包，里面是<br><img src="/img/99.png"><br>这题题目是伪加密，所以我们先来了解一下什么是伪加密</p>
<p>这题叫伪加密， 所以按伪加密来处理，将09 00 改为00 00（只要改为偶数即可）<br>解压得到flag.txt，直接打开即可<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Hrain7/article/details/127719279">BUUCTF MISC zip伪加密</a></p>
<h3 id="被嗅探的流量"><a href="#被嗅探的流量" class="headerlink" title="被嗅探的流量"></a>被嗅探的流量</h3><p>先下载了一个wireshark<br><a target="_blank" rel="noopener" href="https://blog.csdn.net/wangyuxiang946/article/details/124200238">Wireshark零基础使用教程</a></p>
<p>被嗅探的流量.pcapng 默认是用Wireshark打开<br><img src="/img/101.png"><br><strong>寻找POST包</strong>：</p>
<blockquote>
<p>http.request.method&#x3D;&#x3D;POST</p>
</blockquote>
<p><strong>跟踪TCP流</strong>：<br><img src="/img/102.png"><br>得到flag<br><img src="/img/103.png"></p>
<h3 id="镜子里面的世界"><a href="#镜子里面的世界" class="headerlink" title="镜子里面的世界"></a>镜子里面的世界</h3><p><img src="/img/104.png"></p>
<h3 id="FLAG"><a href="#FLAG" class="headerlink" title="FLAG"></a>FLAG</h3><ul>
<li><p>linux系统下file命令用于查询文件类型<br>平时我们判定一个文件的类型通常是通过该文件的扩展名，而file命令是通过详细阅读文件内容，找到特征量来判定文件类型</p>
</li>
<li><p>strings命令在对象文件或二进制文件中查找可打印的字符串</p>
</li>
<li><p>对图片进行尝试，发现最低位隐写的时候是个zip文件：<br><img src="/img/118.png"><br>save bin保存为zip文件,但是文件被损坏<br>进行修复后打开，是一个名为1的文件<br><img src="/img/119.png"><br>我们可以直接尝试使用Notepad++打开<br>从开头可以看出是一个EIF文件</p>
</li>
<li><p>ELF：一种二进制文件格式<br><img src="/img/120.png"><br>可以直接找到flag<br><img src="/img/121.png"><br>也可以使用kali(linux系统就行)<br>执行file .&#x2F;1 和 strings .&#x2F;1<br><img src="/img/122.png"><br><img src="/img/123.png"><br>使用ubuntu18.04直接就.&#x2F;1<br><img src="/img/131.png"><br>不大理解<br>或者直接使用IDA打开<br><img src="/img/124.png"><br>但是目前不会使用IDA</p>
</li>
</ul>
<h3 id="假如给我三天光明"><a href="#假如给我三天光明" class="headerlink" title="假如给我三天光明"></a>假如给我三天光明</h3><p>下载文件，发现该文件里面包含一张图片和一个压缩包<br>双击压缩包无法直接打开<br><img src="/img/125.png"><br>使用zip修复也不行<br>但是发现使用7-zip就可以了<br><img src="/img/126.png"><br>但是需要密码<br>查看那张图片<br>通过16进制编辑器和StegSolve对该图片进行检查，发现并没有突破口<br>这时发现该图片下面有一行不明字符<br><img src="/img/127.png"><br>这段神秘字符为一段盲文，上网对照一下就行<br>经过破译的该段盲文的密码为：kmdonowg<br>将该密码去解压文件中的压缩包，得到一个music.wav音频文件<br>打开该音频文件，发现该文件很像摩斯电码，将该音频文件在Audacity打开<br><img src="/img/129.png"><br>通过该音频可以得到一个摩斯密码：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-.-./-/..-./.--/.--././../-----/---../--.../...--/..---/..--../..---/...--/-../--..</span><br></pre></td></tr></table></figure>
<ul>
<li>解码后的值为：CTFWPEI08732?23DZ<br>将CTF转为flag，其他大写变小写后，才能正确提交flag</li>
<li>转换后的flag为:flag{wpei08732?23dz}</li>
</ul>
<h3 id="荷兰宽带数据泄露"><a href="#荷兰宽带数据泄露" class="headerlink" title="荷兰宽带数据泄露"></a>荷兰宽带数据泄露</h3><p><img src="/img/130.png"><br>.bin文件<br>使用RouterPassView打开文件<br>flag不是username就是password</p>
<h3 id="面具下的flag"><a href="#面具下的flag" class="headerlink" title="面具下的flag"></a>面具下的flag</h3><p>打开是一个图片<br><img src="/img/132.png"><br>查看了图片hex，发现了pk(zip文件的开头)<br>使用binwalk+foremost<br><img src="/img/133.png"><br>把文件保存到物理机打开<br>发现zip文件中的vmdk需要密码，爆破无效<br>考虑到可能是伪加密，09改成00<br><img src="/img/134.png"><br>vmdk文件可以用7z解压：</p>
<ul>
<li>7z x flag.vmdk -o.&#x2F;<br>解压出来的一堆东西里面有：<br><img src="/img/135.png"><br>打开后分别是Brainfuck编码和Ook!编码<br>他们的形式都很显而易见<br>得到的两个部分拼接起来就是flag</li>
</ul>
<h3 id="九连环"><a href="#九连环" class="headerlink" title="九连环"></a>九连环</h3><ul>
<li>binwalk+伪加密+steghide对图片中的信息进行提取</li>
</ul>
<h3 id="BJDCTF2020-你猜我是个啥"><a href="#BJDCTF2020-你猜我是个啥" class="headerlink" title="[BJDCTF2020]你猜我是个啥"></a>[BJDCTF2020]你猜我是个啥</h3><p>解压附件attachment.zip时提示该文件为非压缩文件，联想题目，应该不是压缩包，010打开，开头发现PNG<br>然后拉到结尾直接发现了flag</p>
<h3 id="梅花香之苦寒来"><a href="#梅花香之苦寒来" class="headerlink" title="梅花香之苦寒来"></a>梅花香之苦寒来</h3><p>这题打开是张图片，用010editor打开发现寻找png文件尾，发现文件尾后面还有很长的内容<br><img src="/img/184.png"><br>左边是16进制形式的ascii，右边是对应的内容，这些内容看起来依然是ascii码，猜测是16进制转字符串，试一试发现对应的字符串是坐标，直接使用16进制转字符串的脚本，输出文件flag.txt，然后利用坐标绘制二维码脚本完成解题</p>
<h3 id="谁赢了比赛？"><a href="#谁赢了比赛？" class="headerlink" title="谁赢了比赛？"></a>谁赢了比赛？</h3><p>zip加密，用工具解密后里面是gif文件，用stegsolve打开，使用frame browser查看帧，在310帧看到<br><img src="/img/185.png"><br>save保存图片然后再用stegsolve打开，调整通道，发现一个二维码，扫描即可得到flag</p>
<h3 id="SWPU2019-我有一只马里奥"><a href="#SWPU2019-我有一只马里奥" class="headerlink" title="[SWPU2019]我有一只马里奥"></a>[SWPU2019]我有一只马里奥</h3><p>虽然是ntfs文件流隐写，但是binwalk已经帮我分离出来了<br><img src="/img/186.png"><br><a target="_blank" rel="noopener" href="https://blog.csdn.net/Goodric/article/details/127173751">ntfs文件流隐写</a></p>
<h3 id="GXYCTF2019-gakki-1"><a href="#GXYCTF2019-gakki-1" class="headerlink" title="[GXYCTF2019]gakki 1"></a>[GXYCTF2019]gakki 1</h3><p>分离出压缩包后破解密码拿到flag.txt，打开<br>是这样无规律的字符，这里用到字符统计<br><img src="/img/187.png"></p>
<h3 id="SWPU2019-伟大的侦探1"><a href="#SWPU2019-伟大的侦探1" class="headerlink" title="[SWPU2019]伟大的侦探1"></a>[SWPU2019]伟大的侦探1</h3><p>得到一个压缩包，但是要密码，破解失败，看到有一个密码.txt，打开</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">压缩包密码:摂m墷m卪倕ⅲm仈Z</span><br><span class="line">呜呜呜,我忘记了压缩包密码的编码了,大家帮我解一哈。</span><br></pre></td></tr></table></figure>
<p>用010editor打开，并设置编辑方式-&gt;ebcdlc，发现密码<code>wllm_is_the_best_team!</code><br>福尔摩斯小人密码<br><img src="/img/188.jpg"></p>
<h3 id="黑客帝国"><a href="#黑客帝国" class="headerlink" title="黑客帝国"></a>黑客帝国</h3><p>将.txt文件中的16进制转字符串(或者直接用010editor打开)明显发现是rar文件<br><img src="/img/188.png"><br>使用16进制转文件的脚本转成rar文件,破解密码后打开是一张格式不正确的图片，直接用010打开，发现文件头像是png但不是，文件尾是jpeg的，所以直接将文件头改成jpeg就可以成功打开</p>
<h3 id="HBNIS2018-低个头"><a href="#HBNIS2018-低个头" class="headerlink" title="[HBNIS2018]低个头"></a>[HBNIS2018]低个头</h3><p>键盘隐写，直接看键盘</p>
<h3 id="MRCTF2020-你能看懂音符吗"><a href="#MRCTF2020-你能看懂音符吗" class="headerlink" title="[MRCTF2020]你能看懂音符吗"></a>[MRCTF2020]你能看懂音符吗</h3><p>word显示隐藏文字<br><img src="/img/189.png"><br><a target="_blank" rel="noopener" href="https://www.qqxiuzi.cn/bianma/wenbenjiami.php?s=yinyue">音符解密</a></p>
<h3 id=""><a href="#" class="headerlink" title=""></a></h3><p><a target="_blank" rel="noopener" href="http://www.atoolbox.net/Tool.php?Id=703">aaencode编码</a></p>
<h3 id="buuctf-misc-我吃三明治"><a href="#buuctf-misc-我吃三明治" class="headerlink" title="buuctf misc 我吃三明治"></a>buuctf misc 我吃三明治</h3><p>搜索jpg尾发现后面还有一串，是另一个jpeg文件头，说明这个图片是两张图片拼接而成的，在第一个图片尾和第二个图片头中间有一串base32编码就是flag</p>
<h3 id="SWPU2019-你有没有好好看网课"><a href="#SWPU2019-你有没有好好看网课" class="headerlink" title="[SWPU2019]你有没有好好看网课?"></a>[SWPU2019]你有没有好好看网课?</h3><p>提示flag3的密码是6位<br><img src="/img/191.png"></p>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      
        <div class="post-nav">
          <div class="post-nav-next post-nav-item">
            
              <a href="/linux.html" rel="next" title="linux">
                <i class="fa fa-chevron-left"></i> linux
              </a>
            
          </div>

          <span class="post-nav-divider"></span>

          <div class="post-nav-prev post-nav-item">
            
              <a href="/upload.html" rel="prev" title="upload">
                upload <i class="fa fa-chevron-right"></i>
              </a>
            
          </div>
        </div>
      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          
  


        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            Table of Contents
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            Overview
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name"></p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%7C%7C%20archive">
              
                  <span class="site-state-item-count">41</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                <a href="/tags/index.html">
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">tags</span>
                </a>
              </div>
            

          </nav>

          

          <div class="links-of-author motion-element">
            
          </div>

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%B8%80%E4%BA%9B%E6%80%9D%E8%B7%AF%E6%80%BB%E7%BB%93"><span class="nav-number">1.</span> <span class="nav-text">一些思路总结</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#ISCC-%E5%A5%87%E7%89%B9%E7%9A%84%E4%BF%A1%E6%81%AF"><span class="nav-number">1.1.</span> <span class="nav-text">ISCC 奇特的信息</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#buuctf"><span class="nav-number">2.</span> <span class="nav-text">buuctf</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#zip%E4%BC%AA%E5%8A%A0%E5%AF%86"><span class="nav-number">2.1.</span> <span class="nav-text">zip伪加密</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%A2%AB%E5%97%85%E6%8E%A2%E7%9A%84%E6%B5%81%E9%87%8F"><span class="nav-number">2.2.</span> <span class="nav-text">被嗅探的流量</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%95%9C%E5%AD%90%E9%87%8C%E9%9D%A2%E7%9A%84%E4%B8%96%E7%95%8C"><span class="nav-number">2.3.</span> <span class="nav-text">镜子里面的世界</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#FLAG"><span class="nav-number">2.4.</span> <span class="nav-text">FLAG</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%81%87%E5%A6%82%E7%BB%99%E6%88%91%E4%B8%89%E5%A4%A9%E5%85%89%E6%98%8E"><span class="nav-number">2.5.</span> <span class="nav-text">假如给我三天光明</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8D%B7%E5%85%B0%E5%AE%BD%E5%B8%A6%E6%95%B0%E6%8D%AE%E6%B3%84%E9%9C%B2"><span class="nav-number">2.6.</span> <span class="nav-text">荷兰宽带数据泄露</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%9D%A2%E5%85%B7%E4%B8%8B%E7%9A%84flag"><span class="nav-number">2.7.</span> <span class="nav-text">面具下的flag</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%B9%9D%E8%BF%9E%E7%8E%AF"><span class="nav-number">2.8.</span> <span class="nav-text">九连环</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#BJDCTF2020-%E4%BD%A0%E7%8C%9C%E6%88%91%E6%98%AF%E4%B8%AA%E5%95%A5"><span class="nav-number">2.9.</span> <span class="nav-text">[BJDCTF2020]你猜我是个啥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A2%85%E8%8A%B1%E9%A6%99%E4%B9%8B%E8%8B%A6%E5%AF%92%E6%9D%A5"><span class="nav-number">2.10.</span> <span class="nav-text">梅花香之苦寒来</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%B0%81%E8%B5%A2%E4%BA%86%E6%AF%94%E8%B5%9B%EF%BC%9F"><span class="nav-number">2.11.</span> <span class="nav-text">谁赢了比赛？</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SWPU2019-%E6%88%91%E6%9C%89%E4%B8%80%E5%8F%AA%E9%A9%AC%E9%87%8C%E5%A5%A5"><span class="nav-number">2.12.</span> <span class="nav-text">[SWPU2019]我有一只马里奥</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#GXYCTF2019-gakki-1"><span class="nav-number">2.13.</span> <span class="nav-text">[GXYCTF2019]gakki 1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SWPU2019-%E4%BC%9F%E5%A4%A7%E7%9A%84%E4%BE%A6%E6%8E%A21"><span class="nav-number">2.14.</span> <span class="nav-text">[SWPU2019]伟大的侦探1</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%BB%91%E5%AE%A2%E5%B8%9D%E5%9B%BD"><span class="nav-number">2.15.</span> <span class="nav-text">黑客帝国</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#HBNIS2018-%E4%BD%8E%E4%B8%AA%E5%A4%B4"><span class="nav-number">2.16.</span> <span class="nav-text">[HBNIS2018]低个头</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#MRCTF2020-%E4%BD%A0%E8%83%BD%E7%9C%8B%E6%87%82%E9%9F%B3%E7%AC%A6%E5%90%97"><span class="nav-number">2.17.</span> <span class="nav-text">[MRCTF2020]你能看懂音符吗</span></a></li><li class="nav-item nav-level-3"><a class="nav-link"><span class="nav-number">2.18.</span> <span class="nav-text"></span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#buuctf-misc-%E6%88%91%E5%90%83%E4%B8%89%E6%98%8E%E6%B2%BB"><span class="nav-number">2.19.</span> <span class="nav-text">buuctf misc 我吃三明治</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#SWPU2019-%E4%BD%A0%E6%9C%89%E6%B2%A1%E6%9C%89%E5%A5%BD%E5%A5%BD%E7%9C%8B%E7%BD%91%E8%AF%BE"><span class="nav-number">2.20.</span> <span class="nav-text">[SWPU2019]你有没有好好看网课?</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2024</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">yzklov</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.3</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>

  
  <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>

  
  <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>

  
  <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.3"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.3"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.3"></script>



  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.3"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.3"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.3"></script>



  


  




	





  





  








  

  <script type="text/javascript">
    // Popup Window;
    var isfetched = false;
    var isXml = true;
    // Search DB path;
    var search_path = "search.json";
    if (search_path.length === 0) {
      search_path = "search.xml";
    } else if (/json$/i.test(search_path)) {
      isXml = false;
    }
    var path = "/" + search_path;
    // monitor main search box;

    var onPopupClose = function (e) {
      $('.popup').hide();
      $('#local-search-input').val('');
      $('.search-result-list').remove();
      $('#no-result').remove();
      $(".local-search-pop-overlay").remove();
      $('body').css('overflow', '');
    }

    function proceedsearch() {
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay"></div>')
        .css('overflow', 'hidden');
      $('.search-popup-overlay').click(onPopupClose);
      $('.popup').toggle();
      var $localSearchInput = $('#local-search-input');
      $localSearchInput.attr("autocapitalize", "none");
      $localSearchInput.attr("autocorrect", "off");
      $localSearchInput.focus();
    }

    // search function;
    var searchFunc = function(path, search_id, content_id) {
      'use strict';

      // start loading animation
      $("body")
        .append('<div class="search-popup-overlay local-search-pop-overlay">' +
          '<div id="search-loading-icon">' +
          '<i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i>' +
          '</div>' +
          '</div>')
        .css('overflow', 'hidden');
      $("#search-loading-icon").css('margin', '20% auto 0 auto').css('text-align', 'center');

      $.ajax({
        url: path,
        dataType: isXml ? "xml" : "json",
        async: true,
        success: function(res) {
          // get the contents from search data
          isfetched = true;
          $('.popup').detach().appendTo('.header-inner');
          var datas = isXml ? $("entry", res).map(function() {
            return {
              title: $("title", this).text(),
              content: $("content",this).text(),
              url: $("url" , this).text()
            };
          }).get() : res;
          var input = document.getElementById(search_id);
          var resultContent = document.getElementById(content_id);
          var inputEventFunction = function() {
            var searchText = input.value.trim().toLowerCase();
            var keywords = searchText.split(/[\s\-]+/);
            if (keywords.length > 1) {
              keywords.push(searchText);
            }
            var resultItems = [];
            if (searchText.length > 0) {
              // perform local searching
              datas.forEach(function(data) {
                var isMatch = false;
                var hitCount = 0;
                var searchTextCount = 0;
                var title = data.title.trim();
                var titleInLowerCase = title.toLowerCase();
                var content = data.content.trim().replace(/<[^>]+>/g,"");
                var contentInLowerCase = content.toLowerCase();
                var articleUrl = decodeURIComponent(data.url);
                var indexOfTitle = [];
                var indexOfContent = [];
                // only match articles with not empty titles
                if(title != '') {
                  keywords.forEach(function(keyword) {
                    function getIndexByWord(word, text, caseSensitive) {
                      var wordLen = word.length;
                      if (wordLen === 0) {
                        return [];
                      }
                      var startPosition = 0, position = [], index = [];
                      if (!caseSensitive) {
                        text = text.toLowerCase();
                        word = word.toLowerCase();
                      }
                      while ((position = text.indexOf(word, startPosition)) > -1) {
                        index.push({position: position, word: word});
                        startPosition = position + wordLen;
                      }
                      return index;
                    }

                    indexOfTitle = indexOfTitle.concat(getIndexByWord(keyword, titleInLowerCase, false));
                    indexOfContent = indexOfContent.concat(getIndexByWord(keyword, contentInLowerCase, false));
                  });
                  if (indexOfTitle.length > 0 || indexOfContent.length > 0) {
                    isMatch = true;
                    hitCount = indexOfTitle.length + indexOfContent.length;
                  }
                }

                // show search results

                if (isMatch) {
                  // sort index by position of keyword

                  [indexOfTitle, indexOfContent].forEach(function (index) {
                    index.sort(function (itemLeft, itemRight) {
                      if (itemRight.position !== itemLeft.position) {
                        return itemRight.position - itemLeft.position;
                      } else {
                        return itemLeft.word.length - itemRight.word.length;
                      }
                    });
                  });

                  // merge hits into slices

                  function mergeIntoSlice(text, start, end, index) {
                    var item = index[index.length - 1];
                    var position = item.position;
                    var word = item.word;
                    var hits = [];
                    var searchTextCountInSlice = 0;
                    while (position + word.length <= end && index.length != 0) {
                      if (word === searchText) {
                        searchTextCountInSlice++;
                      }
                      hits.push({position: position, length: word.length});
                      var wordEnd = position + word.length;

                      // move to next position of hit

                      index.pop();
                      while (index.length != 0) {
                        item = index[index.length - 1];
                        position = item.position;
                        word = item.word;
                        if (wordEnd > position) {
                          index.pop();
                        } else {
                          break;
                        }
                      }
                    }
                    searchTextCount += searchTextCountInSlice;
                    return {
                      hits: hits,
                      start: start,
                      end: end,
                      searchTextCount: searchTextCountInSlice
                    };
                  }

                  var slicesOfTitle = [];
                  if (indexOfTitle.length != 0) {
                    slicesOfTitle.push(mergeIntoSlice(title, 0, title.length, indexOfTitle));
                  }

                  var slicesOfContent = [];
                  while (indexOfContent.length != 0) {
                    var item = indexOfContent[indexOfContent.length - 1];
                    var position = item.position;
                    var word = item.word;
                    // cut out 100 characters
                    var start = position - 20;
                    var end = position + 80;
                    if(start < 0){
                      start = 0;
                    }
                    if (end < position + word.length) {
                      end = position + word.length;
                    }
                    if(end > content.length){
                      end = content.length;
                    }
                    slicesOfContent.push(mergeIntoSlice(content, start, end, indexOfContent));
                  }

                  // sort slices in content by search text's count and hits' count

                  slicesOfContent.sort(function (sliceLeft, sliceRight) {
                    if (sliceLeft.searchTextCount !== sliceRight.searchTextCount) {
                      return sliceRight.searchTextCount - sliceLeft.searchTextCount;
                    } else if (sliceLeft.hits.length !== sliceRight.hits.length) {
                      return sliceRight.hits.length - sliceLeft.hits.length;
                    } else {
                      return sliceLeft.start - sliceRight.start;
                    }
                  });

                  // select top N slices in content

                  var upperBound = parseInt('1');
                  if (upperBound >= 0) {
                    slicesOfContent = slicesOfContent.slice(0, upperBound);
                  }

                  // highlight title and content

                  function highlightKeyword(text, slice) {
                    var result = '';
                    var prevEnd = slice.start;
                    slice.hits.forEach(function (hit) {
                      result += text.substring(prevEnd, hit.position);
                      var end = hit.position + hit.length;
                      result += '<b class="search-keyword">' + text.substring(hit.position, end) + '</b>';
                      prevEnd = end;
                    });
                    result += text.substring(prevEnd, slice.end);
                    return result;
                  }

                  var resultItem = '';

                  if (slicesOfTitle.length != 0) {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + highlightKeyword(title, slicesOfTitle[0]) + "</a>";
                  } else {
                    resultItem += "<li><a href='" + articleUrl + "' class='search-result-title'>" + title + "</a>";
                  }

                  slicesOfContent.forEach(function (slice) {
                    resultItem += "<a href='" + articleUrl + "'>" +
                      "<p class=\"search-result\">" + highlightKeyword(content, slice) +
                      "...</p>" + "</a>";
                  });

                  resultItem += "</li>";
                  resultItems.push({
                    item: resultItem,
                    searchTextCount: searchTextCount,
                    hitCount: hitCount,
                    id: resultItems.length
                  });
                }
              })
            };
            if (keywords.length === 1 && keywords[0] === "") {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-search fa-5x" /></div>'
            } else if (resultItems.length === 0) {
              resultContent.innerHTML = '<div id="no-result"><i class="fa fa-frown-o fa-5x" /></div>'
            } else {
              resultItems.sort(function (resultLeft, resultRight) {
                if (resultLeft.searchTextCount !== resultRight.searchTextCount) {
                  return resultRight.searchTextCount - resultLeft.searchTextCount;
                } else if (resultLeft.hitCount !== resultRight.hitCount) {
                  return resultRight.hitCount - resultLeft.hitCount;
                } else {
                  return resultRight.id - resultLeft.id;
                }
              });
              var searchResultList = '<ul class=\"search-result-list\">';
              resultItems.forEach(function (result) {
                searchResultList += result.item;
              })
              searchResultList += "</ul>";
              resultContent.innerHTML = searchResultList;
            }
          }

          if ('auto' === 'auto') {
            input.addEventListener('input', inputEventFunction);
          } else {
            $('.search-icon').click(inputEventFunction);
            input.addEventListener('keypress', function (event) {
              if (event.keyCode === 13) {
                inputEventFunction();
              }
            });
          }

          // remove loading animation
          $(".local-search-pop-overlay").remove();
          $('body').css('overflow', '');

          proceedsearch();
        }
      });
    }

    // handle and trigger popup window;
    $('.popup-trigger').click(function(e) {
      e.stopPropagation();
      if (isfetched === false) {
        searchFunc(path, 'local-search-input', 'local-search-result');
      } else {
        proceedsearch();
      };
    });

    $('.popup-btn-close').click(onPopupClose);
    $('.popup').click(function(e){
      e.stopPropagation();
    });
    $(document).on('keyup', function (event) {
      var shouldDismissSearchPopup = event.which === 27 &&
        $('.search-popup').is(':visible');
      if (shouldDismissSearchPopup) {
        onPopupClose();
      }
    });
  </script>





  

  

  

  

  

  

  
  <style>
    .copy-btn {
      display: inline-block;
      padding: 6px 12px;
      font-size: 13px;
      font-weight: 700;
      line-height: 20px;
      color: #4D4D4C;
      white-space: nowrap;
      vertical-align: middle;
      cursor: pointer;
      background-color: #F7F7F7;
      background-image: linear-gradient(#F7F7F7, #F7F7F7);
      border: 1px solid #d5d5d5;
      border-radius: 3px;
      user-select: none;
      outline: 0;
    }

    .highlight-wrap .copy-btn {
      transition: opacity .3s ease-in-out;
      opacity: 0;
      padding: 2px 6px;
      position: absolute;
      right: 4px;
      top: 8px;
    }

    .highlight-wrap:hover .copy-btn,
    .highlight-wrap .copy-btn:focus {
      opacity: 1
    }

    .highlight-wrap {
      position: relative;
    }
  </style>

  <script>
    $('.highlight').each(function (i, e) {
      var $wrap = $('<div>').addClass('highlight-wrap')
      $(e).after($wrap)
      $wrap.append($('<button>').addClass('copy-btn').append('Copy').on('click', function (e) {
        var code = $(this).parent().find('.code').find('.line').map(function (i, e) {
          return $(e).text()
        }).toArray().join('\n')
        var ta = document.createElement('textarea')
        document.body.appendChild(ta)
        ta.style.position = 'absolute'
        ta.style.top = '0px'
        ta.style.left = '0px'
        ta.value = code
        ta.select()
        ta.focus()
        var result = document.execCommand('copy')
        document.body.removeChild(ta)
        
          if(result)$(this).text('Copied')
          else $(this).text('Copy failed')
        
        $(this).blur()
      })).on('mouseleave', function (e) {
        var $b = $(this).find('.copy-btn')
        setTimeout(function () {
          $b.text('Copy')
        }, 300)
      }).append(e)
    })
  </script>

 
</body>
</html>
